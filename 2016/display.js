var continueWithoutHive=!1,intervalId,countdownEnded=!1,elMainContainer,elMessage,elNotStarted,elNotScheduled,elPlayer,elError,elErrorMsg,elBanner,elHiveNotInstalledBackground,elBannerButton,elHiveNotInstalled,elTVGuide,elTVGuideBackground,elPasswordProtection,elPassword,elBackgroundImage,display={countdownTimer:function(){player.debug&&console.log("debug: eventService.countdownTimer"),clearInterval(intervalId);var e=moment(eventService.event.time.start),t=moment.utc().subtract("ms",eventService.event.timeOffset),n=e.diff(t,"milliseconds",!0);if(n<-100)display.hideAll(),player.autoPlay?tabFocus?playerHandler.playerInit():countdownEnded=!0:display.setUpBanner();else{var l=Math.floor(moment.duration(n).asDays());n=e.subtract("days",l).diff(t,"milliseconds",!0);var i=Math.floor(moment.duration(n).asHours());n=e.subtract("hours",i).diff(t,"milliseconds",!0);var r=Math.floor(moment.duration(n).asMinutes());n=e.subtract("minutes",r).diff(t,"milliseconds",!0);var a=Math.floor(moment.duration(n).asSeconds());display.setElementTime(l,"startingInDays"),display.setElementTime(i,"startingInHours"),display.setElementTime(r,"startingInMinutes"),display.setElementTime(a,"startingInSeconds"),intervalId=setInterval(display.countdownTimer,1e3)}},setElementTime:function(e,t){var n,l=e.toString().split("");3==l.length?(n=e.toString(),document.getElementById("startingDaysDiv").style.marginLeft="3%",document.getElementById("startingDaysDiv").style.width="19%",document.getElementById("startingInDays").style.marginTop="14%",document.getElementById("StartDateDays").style.marginTop="7%"):n=2==l.length?"-"===l[0]?"00":e.toString():l.length>=1?"0"+l[0].toString():"00",document.getElementById(t).innerHTML=n},fillDomElements:function(){player.debug&&console.log("debug: display.fillDomElements"),elMessage=document.getElementById("Message"),elNotStarted=document.getElementById("EventHasNotStarted"),elNotScheduled=document.getElementById("EventNotScheduled"),elPlayer=document.getElementById("PlayerContainer"),elError=document.getElementById("Error"),elErrorMsg=document.getElementById("ErrorMsg"),elBanner=document.getElementById("Banner"),elBannerButton=document.getElementById("BannerButton"),elHiveNotInstalled=document.getElementById("HiveNotInstalled"),elHiveNotInstalledBackground=document.getElementById("HiveNotInstalledBackground"),elPasswordProtection=document.getElementById("PasswordProtection"),elPassword=document.getElementById("PasswordTextBox"),elMainContainer=document.getElementById("MainContainer"),elBackgroundImage=document.getElementById("backgroundImage")},hideAll:function(){player.debug&&console.log("debug: display.hideAll"),elBanner.visible(!1),elNotStarted.visible(!1),elNotScheduled.visible(!1),elPlayer.visible(!1),elError.visible(!1),elHiveNotInstalled.visible(!1),playerHandler.state=playerState.notInitialized},setUpBanner:function(){player.debug&&console.log("debug: eventService.setUpBanner"),"block"==elError.style.display||(elBannerButton.setAttribute("src",player.playIconPNG),elBackgroundImage.setAttribute("src",eventService.event.playerBackground),elBanner.visible(!0),playerHandler.state=playerState.showingBanner)},isShowingInstaller:!1,showMessage:function(e){elMessage.innerText=e,elMessage.visible(!0)},removeMessage:function(){elMessage.innerText="",elMessage.visible(!1)},showError:function(e){player.debug&&(console.log("debug: eventService.showError"),console.log("debug: error message: "+e.message)),elBanner.visible(!1),elPlayer.visible(!1),elError.style.backgroundImage=e.imageUrl?"url("+e.imageUrl+")":"url("+player.errorBgJPG+")",e.imageUrl&&(elErrorMsg.style.fontSize="3vw"),elError.visible(!0),document.getElementById("ErrorParagraph").innerHTML=e.message,eventService.isChannel&&e.message==errorMessages.videoNotAvailable&&setTimeout(app.startChannel,5e3)},showBlank:function(){elBanner.visible(!1),elPlayer.visible(!1),elError.style.backgroundColor="#000",elError.visible(!0)},showErrorMessageTillProgramEndTime:function(){var e=moment(),t=1e3*moment(player.currentShowing.end_time).diff(e,"seconds")+5;setTimeout(playerHandler.showChannelProgramsSchedule,t)},showInstaller:function(){player.debug&&console.log("debug: eventService.showInstaller");var e,t,n;t=eventService.platform.isHiveInstalled;var l=Q.defer();return e=eventService.event.status,n=eventService.event.useHive,display.isShowingInstaller||continueWithoutHive||e===eventStatusType.completed||!n||t||eventService.platform.isMobile||player.preview?l.resolve():eventService.getHiveInstaller().then(function(){var e,t,n,i;if(document.getElementById("HiveNotInstalledTitle").innerHTML=errorMessages.hiveNotInstalledTitle,e=document.createElement("div"),e.id="InstallHive",n=document.createElement("a"),i="http://cdn.hivestreaming.com/"+eventService.event.installer.basePath+"/"+eventService.event.installer.targetEnv+"/"+eventService.event.installer.fileName,n.setAttribute("href",i),n.setAttribute("target","_blank"),(t=document.createElement("img")).setAttribute("src",player.getHiveStreamingPNG),t.className="hiveClientDownloadImage","Firefox"==eventService.userAgent.browser.name){t.className="hiveClientDownloadImage firefox";var r=document.createElement("p");r.className="hiveCertificateWarningTitle",r.innerHTML="Notice to Firefox users.";var a=document.createElement("p");a.innerHTML=errorMessages.hiveCertificateWarning,a.className="hiveCertificateWarningParagraph",elHiveNotInstalled.appendChild(r),elHiveNotInstalled.appendChild(a)}n.appendChild(t),e.appendChild(n),elHiveNotInstalled.appendChild(e),display.isShowingInstaller=!0,l.resolve(),eventService.isChannel&&display.showErrorMessageTillProgramEndTime()}).catch(function(e){l.reject(e)}),l.promise},removeInstaller:function(){var e=document.getElementById("InstallHive");switch(eventService.event.status){case eventStatusType.started:document.getElementById("MainContainer").removeChild(e);break;case eventStatusType.notStarted:elNotStarted.removeChild(e)}this.isShowingInstaller=!1},fillTVGuideElements:function(){elTVGuide=document.getElementById("TVGuide"),elTVGuideBackground=document.getElementById("TVGuideBackground")},hidePlayerBanner:function(){elBanner&&elBanner.visible(!1),elPlayer&&elPlayer.visible(!1),elError&&elError.visible(!1),elHiveNotInstalled&&elHiveNotInstalled.visible(!1)},displayUpcomingPrograms:function(){this.fillTVGuideElements(),elTVGuide.visible(!0);var e='<div class="tvGuideText"> TV GUIDE </div>',t="";$.each(player.upcomingChannelPrograms,function(n,l){var i=l.name;i.length>48&&(i=i.substring(0,48)+"..."),moment(l.start_time).format("YYYYMMDD")!=t&&(t=moment(l.start_time).format("YYYYMMDD"),e+='<div class="tvGuideContent">'+moment(l.start_time).format("dddd MMM DD")+"</div>"),e+='<div class="programContent">'+moment(l.start_time).format("HH:mm")+" "+i+"</div>"}),$("#upcomingSchedule").html(e)},displayNoUpcomingPrograms:function(){this.fillTVGuideElements(),elTVGuide.visible(!0);var e='<div class="tvGuideText" style="margin-bottom: 32px;"> TV GUIDE </div>';e+='<div style="font-family:arial; font-size:4.5vh; text-align:left;">No upcoming events</div>',$("#upcomingSchedule").html(e)},setChannelImage:function(){document.getElementById("backgroundImage").style.display="none",elTVGuideBackground.setAttribute("src",player.errorBgJPG)},hideTVGuide:function(){elTVGuide.visible(!1)},addPlayerHTML:function(){var e=document.createElement("video");e.id="vid1",e.className="azuremediaplayer amp-default-skin";var t=document.createElement("p");t.className="amp-no-js",t.innerHTML="No compatible source found for the current browser environment. Try installing Flash plugin or use a different browser.",e.appendChild(t),elPlayer.appendChild(e)},displayPassword:function(){elBannerButton.style.visibility="hidden",elBackgroundImage.setAttribute("src",eventService.event.playerBackground),elPlayer.visible(!1),elPasswordProtection.visible(!0),elPassword.focus(),elPassword.contenteditable="true"},wrongPasswordAlarm:function(){elPassword.style.backgroundColor="#FFCCCC"},PasswordIsHidden:function(){return"none"===elPasswordProtection.style.display},addPlayerEventTitle:function(){var e=document.getElementById("vid1"),t=document.createElement("div"),n=document.createElement("p");t.className="vjs-event-title",n.className="vjs-title-text",n.innerHTML=decodeURIComponent(eventService.event.title),t.appendChild(n),e.appendChild(t)},addCountdownBg:function(){if(elBackgroundImage.src=eventService.event.playerBackground,"IE"!==eventService.browser.name);else{var e=document.createElement("div");e.id="glassDiv",elNotStarted.appendChild(e)}},createUpdateCaptionOverlay:function(e){if(playerHandler.showCaption){var t=document.getElementById("caption-text");if(t){t.innerHTML=e;var n=document.getElementById("caption-overlay");n.style=""===e?"display: none; background-color: none;":"display: block; background-color: rgba(0, 0, 0, 0.55);"}else{var l=document.getElementById("vid1"),i=document.createElement("div");t=document.createElement("p"),i.id="caption-overlay",t.id="caption-text",t.innerHTML=decodeURIComponent(e),i.appendChild(t),l.appendChild(i)}}},createCaptionsSettings:function(){var e=document.getElementById("vid1"),t=document.createElement("div"),n=document.createElement("p"),l=document.createElement("p"),i=document.createElement("p");t.id="caption-settings",n.id="captionFontSizeSmall",l.id="captionFontSizeMedium",i.id="captionFontSizeLarge",n.style="width: 33%; height: 33%;",l.style="width: 33%; height: 33%;",i.style="width: 33%; height: 33%;",n.innerHTML="Small Font",l.innerHTML="Medium Font",i.innerHTML="Large Font",n.setAttribute("onclick","playerHandler.setSmallCaptionFont()"),l.setAttribute("onclick","playerHandler.setMediumCaptionFont()"),i.setAttribute("onclick","playerHandler.setLargeCaptionFont()"),t.appendChild(n),t.appendChild(l),t.appendChild(i),e.appendChild(t)}};